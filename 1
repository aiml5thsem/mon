import wrapt
import inspect
from mcp_agent.mcp.mcp_aggregator import MCPAggregator

tool_log = []

@wrapt.decorator
async def log_call_tool_async(wrapped, instance, args, kwargs):
    name = args[0] if args else kwargs.get("name")
    arguments = args[1] if len(args) > 1 else kwargs.get("arguments")
    tool_log.append((name, arguments))
    return await wrapped(*args, **kwargs)

# Apply to the method
MCPAggregator.call_tool = log_call_tool_async(MCPAggregator.call_tool)
